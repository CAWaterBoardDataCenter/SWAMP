---
title: "SWAMP Physical Habitat Data Verification"
author: "Marc Petta"
date: "January 2018"
output:
  word_document: default
  xlsx: default
---

### SWAMP Field Measurements and Physical Habitat Template Verification Automation

Whats follows is an automoation of the SWAMP Physical Habitat Verification method. This does not automate SWAMP Completeness Checks and every effort must continue to be made during those checks to determine final completeness and validation of data under review. This replaces existing manual review methods for determing data is of sufficient quality to be entered into the SWAMP database and is compliant with business rules.

##For using this script ensure the file read is saved as xlsx.

ASSUMPTIONS:
What follows assumes that xlsx formatting matches what is generated by the Extraction Tool; assumes all constituents are fixed as of November 2018 and that each analyte has fixed units of measurement; treats all project grouped data equally and consideration should be made whether to apply this to non SWAMP data.

All valid range determination research was verified by ranges observed in SWAMP histroic data; 2017 and before.

Please note that this verifies common Physical Habitat data submitted to SWAMP. New constituents/anlaytes need to be added here when they develop. If the file read here has uncommon or new constituents (as of November 2018) they will need to be reviewed manually.

```{r}
#Install packages initially and load libraries each instance

#install.packages("dplyr")
#install.packages("readxl")
#install.packages("writexl")

library(dplyr)
library(readxl)
library(writexl)

```

## SWAMP Physical Habitat Data Verification

```{r}
#Save SWAMP Field Measurements and Physical Habitat Template (xlsx) to working directory

#Read in the file that is to be verified. Reads specified sheet (HabitatResults) and set col types Code below pointed towards (swamp.xlsx). Rename appropriately. 
swamp = read_excel("swamp.xlsx", 
                   sheet = "HabitatResults",
                   col_types = c("text", "text", "text", "text", "text", "text", "text", "text", "text", "text", "text", "numeric", "text", "text", "text", "text", "text", "text", "text", "numeric", "text", "text", "text", "text", "text", "text"))

#Transform col types as date time 
mutate(swamp, SampleDate= as.Date(SampleDate, format= "%d.%m.%Y"))
mutate(swamp, CollectionTime= as.Date(CollectionTime, format= "%H:%M:%S"))

#Review to ensure the data frame has the appropriate headers and formatted correctly.
head(swamp)
```

##Verification

```{r}
########################## VERIFICATION ###############################

  # ifelse operations in base - Retain existing Compliance Code

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "AssemblageIDAlgaeSampleVolume" & swamp$Result == 45, "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "AssemblageIDDiatomSampleVolume" & swamp$Result == 40, "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "AssemblageIDDiatomSampleVolume" & swamp$Result == 45, "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Bank Stability" & swamp$VariableResult == "stable", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Bank Stability" & swamp$VariableResult == "vulnerable", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Bank Stability" & swamp$VariableResult == "eroded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Bank Stability" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Channel Engineered" & swamp$VariableResult == "No", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Channel Engineered" & swamp$VariableResult == "Yes", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Brown", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Colorless", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Yellow", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "brown/yellow", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Yellow/Brown", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Green", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Mixed", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Black", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Green/Brown", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Color" & swamp$VariableResult == "Black/Brown", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "CPOM" & swamp$VariableResult == "Present", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "CPOM" & swamp$VariableResult == "Dry", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "CPOM" & swamp$VariableResult == "Absent", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "CPOM" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Dominant Land Use" & swamp$VariableResult == "Forest", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Dominant Land Use" & swamp$VariableResult == "Urban/Industrial", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Dominant Land Use" & swamp$VariableResult == "Agriculture", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Dominant Land Use" & swamp$VariableResult == "Suburban, Town", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Dominant Land Use" & swamp$VariableResult == "Range", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Dominant Land Use" & swamp$VariableResult == "Other", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Bedrock", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Gravel", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Mud", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Cobble", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Sand", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Unknown", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Concrete", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Boulder", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "DominantSubstrate" & swamp$VariableResult == "Other", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Fire" & swamp$VariableResult == "No", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Fire" & swamp$VariableResult == "NO", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Fire" & swamp$VariableResult == "< 5 years", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Fire" & swamp$VariableResult == "< 1 year", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Recent Rainfall" & swamp$VariableResult == "No", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Recent Rainfall" & swamp$VariableResult == "NO", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Recent Rainfall" & swamp$VariableResult == "minimal", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Recent Rainfall" & swamp$VariableResult == "Yes", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Recent Rainfall" & swamp$VariableResult == "YES", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Scour" & swamp$VariableResult == "No", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Evidence of Scour" & swamp$VariableResult == "Yes", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Artificial Structures" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Boulders" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Filamentous Algae" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Live Trees/Roots" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Macrophytes" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Overhang.Veg" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Undercut Banks" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Woody Debris <0.3 m" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Fish Cover Woody Debris >0.3 m" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Glide/Pool Channel Alteration" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Glide/Pool Epifaunal Substrate" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Glide/Pool Sediment Deposition" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Attached" & swamp$VariableResult == "Present", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Attached" & swamp$VariableResult == "Dry", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Attached" & swamp$VariableResult == "Absent", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Attached" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Unattached" & swamp$VariableResult == "Present", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Unattached" & swamp$VariableResult == "Dry", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Unattached" & swamp$VariableResult == "Absent", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macroalgae Cover, Unattached" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macrophyte Cover" & swamp$VariableResult == "Present", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macrophyte Cover" & swamp$VariableResult == "Dry", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macrophyte Cover" & swamp$VariableResult == "Absent", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Macrophyte Cover" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "0.1 -1 cfs", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "1-5 cfs", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "5-20 cfs", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "20-50 cfs", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "No Observed Flow", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "50-200 cfs", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "NA", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == ">200 cfs", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "Trickle (<0.1 cfs)", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "Isolated Pool", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedFlow" & swamp$VariableResult == "Dry Waterbody Bed", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "Manure", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "Mixed", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "None", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "Other", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "Petroleum", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "Sewage", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Odor" & swamp$VariableResult == "Sulfides", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Foam", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "None", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Non-Vascular", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Oily Sheen", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Other", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Periphyton", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Trash", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Vascular", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OtherPresence" & swamp$VariableResult == "Vascular/Non-Vascular", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedChannelFlowLevel" & swamp$VariableResult == "Low", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedChannelFlowLevel" & swamp$VariableResult == "High", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedChannelFlowLevel" & swamp$VariableResult == "Flood", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedChannelFlowLevel" & swamp$VariableResult == "Normal", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "ObservedChannelFlowLevel" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OverlandRunoffLast24hrs" & swamp$VariableResult == "Light Precip", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OverlandRunoffLast24hrs" & swamp$VariableResult == "Mod to Heavy Precip", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OverlandRunoffLast24hrs" & swamp$VariableResult == "None", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "OverlandRunoffLast24hrs" & swamp$VariableResult == "Unknown", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "PictureCode", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Precipitation" & swamp$VariableResult == "Drizzle", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Precipitation" & swamp$VariableResult == "Fog", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Precipitation" & swamp$VariableResult == "None", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Precipitation" & swamp$VariableResult == "Rain", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "PrecipitationLast24hrs" & swamp$VariableResult == "<1 inch", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "PrecipitationLast24hrs" & swamp$VariableResult == ">1 inch", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "PrecipitationLast24hrs" & swamp$VariableResult == "None", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "PrecipitationLast24hrs" & swamp$VariableResult == "Unknown", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "SkyCode" & swamp$VariableResult == "Partly Cloudy", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "SkyCode" & swamp$VariableResult == "Clear", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "SkyCode" & swamp$VariableResult == "Fog", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "SkyCode" & swamp$VariableResult == "Hazy", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "SkyCode" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "SkyCode" & swamp$VariableResult == "Overcast", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "RS", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "RR", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "RC", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "XB", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "SB", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "CB", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "GC", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "GF", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "SA", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "FN", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "HP", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "WD", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Substrate Size Class" & swamp$VariableResult == "OT", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "TransectsSampled" & swamp$Result == 11, "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Wadeability" & swamp$VariableResult == "Wadeable", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Wadeability" & swamp$VariableResult == "Non-Wadeable", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Wadeability" & swamp$VariableResult == "Unknown", "Com", swamp$ComplianceCode)

####Check for WaterClarity not fully working due to swamp$VariableResult values containg special characters####   MANUAL REVIEW REQUIRED

#swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WaterClarity" & swamp$VariableResult == "Clear", "Com", swamp$ComplianceCode)

#swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WaterClarity" & swamp$VariableResult == "Cloudy (> 4" vis.)", "Com", swamp$ComplianceCode)

#swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WaterClarity" & swamp$VariableResult == "Murky (< 4" vis.)", "Com", swamp$ComplianceCode)

#swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WaterClarity" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "SE", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "XX", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "SW", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "S", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "NW", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "W", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "NE", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "E", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "WindDirection" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

```
##Verification

```{r}
########################## VERIFICATION ###############################

  # CaseWhen operations with dplyr - mutate remaining Compliance Codes

swamp <-
  swamp %>%
  mutate(ComplianceCode = case_when( 
    AnalyteName == "Algae-attached" & Result < 0 ~ "QAORR",
    AnalyteName == "Algae-attached" & Result > 100 ~ "QAORR",
    AnalyteName == "Algae-attached" & Result == 0:100 ~ "Com",
    
    # Bankfull Height NEEDS TO BE COERCED TO NUMERIC Currently this will not affect records where          Result is not an integer   MANUAL REVIEW REQUIRED
    AnalyteName == "Bankfull Height" & Result < 0 ~ "QAORR",
    AnalyteName == "Bankfull Height" & Result > 4 ~ "QAORR",
    AnalyteName == "Bankfull Height" & Result == 0:4 ~ "Com",
    
    # Bankfull Width NEEDS TO BE COERCED TO NUMERIC Currently this will not affect records where           Result is not an integer   MANUAL REVIEW REQUIRED
    AnalyteName == "Bankfull Width" & Result < 0 ~ "QAORR",
    AnalyteName == "Bankfull Width" & Result > 50 ~ "QAORR",
    AnalyteName == "Bankfull Width" & Result == 0:50 ~ "Com",
    
    AnalyteName == "Bearing" & Result < 0 ~ "QAORR",
    AnalyteName == "Bearing" & Result > 360 ~ "QAORR",
    AnalyteName == "Bearing" & Result %in% 0:360 ~ "Com",
    
    AnalyteName == "BeaufortScale" & Result < 0 ~ "QAORR",
    AnalyteName == "BeaufortScale" & Result > 5 ~ "QAORR",
    AnalyteName == "BeaufortScale" & Result %in% 0:5 ~ "Com",
    
    AnalyteName == "BiomassSampleVolume" & Result < 0 ~ "QAORR",
    AnalyteName == "BiomassSampleVolume" & Result > 25 ~ "QAORR",
    AnalyteName == "BiomassSampleVolume" & Result %in% 0:25 ~ "Com",
    
    AnalyteName == "Canopy Cover" & Result < 0 ~ "QAORR",
    AnalyteName == "Canopy Cover" & Result > 17 ~ "QAORR",
    AnalyteName == "Canopy Cover" & Result %in% 0:17 ~ "Com",
    
    AnalyteName == "Cascade/Falls" & Result < 0 ~ "QAORR",
    AnalyteName == "Cascade/Falls" & Result > 100 ~ "QAORR",
    AnalyteName == "Cascade/Falls" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "ChlorophyllSampleVolume" & Result < 0 ~ "QAORR",
    AnalyteName == "ChlorophyllSampleVolume" & Result > 150 ~ "QAORR",
    AnalyteName == "ChlorophyllSampleVolume" & Result %in% 0:150 ~ "Com",
    
    AnalyteName == "CompositeVolume" & Result < 0 ~ "QAORR",
    AnalyteName == "CompositeVolume" & Result > 1250 ~ "QAORR",
    AnalyteName == "CompositeVolume" & Result %in% 0:1250 ~ "Com",
    
    AnalyteName == "CSCI" & Result < 0 ~ "QAORR",
    AnalyteName == "CSCI" & Result > 2 ~ "QAORR",
    AnalyteName == "CSCI" & Result %in% 0:2 ~ "Com",
    
    AnalyteName == "CSCI_Percentile" & Result < 0 ~ "QAORR",
    AnalyteName == "CSCI_Percentile" & Result > 1 ~ "QAORR",
    AnalyteName == "CSCI_Percentile" & Result %in% 0:1 ~ "Com",
    
    # DistanceFromBank NEEDS TO BE COERCED TO NUMERIC Currently this will not affect records where         Result is not an integer    MANUAL REVIEW REQUIRED
    AnalyteName == "Distance from Bank" & Result < 0 ~ "QAORR",
    AnalyteName == "Distance from Bank" & UnitName == "m" & Result > 35 ~ "QAORR",
    AnalyteName == "Distance from Bank" & UnitName == "m" & Result %in% 0:35 ~ "Com",

    AnalyteName == "Distance from Bank" & UnitName == "cm" & Result > 16000 ~ "QAORR",
    AnalyteName == "Distance from Bank" & UnitName == "cm" & Result %in% 0:16000 ~ "Com",
    
    AnalyteName == "Distance, Float" & Result < 0 ~ "QAORR",
    AnalyteName == "Distance, Float" & Result > 15 ~ "QAORR",
    AnalyteName == "Distance, Float" & Result %in% 0:15 ~ "Com",
    
    AnalyteName == "Dry" & Result < 0 ~ "QAORR",
    AnalyteName == "Dry" & Result > 100 ~ "QAORR",
    AnalyteName == "Dry" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Elevation Difference" & Result < -20 ~ "QAORR",
    AnalyteName == "Elevation Difference" & Result > 300 ~ "QAORR",
    AnalyteName == "Elevation Difference" & Result %in% -20:300 ~ "Com",
    
    AnalyteName == "Embeddedness" & Result < 0 ~ "QAORR",
    AnalyteName == "Embeddedness" & Result > 100 ~ "QAORR",
    AnalyteName == "Embeddedness" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Fish Cover Artificial Structures" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Artificial Structures" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Artificial Structures" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Boulders" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Boulders" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Boulders" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Filamentous Algae" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Filamentous Algae" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Filamentous Algae" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Live Trees/Roots" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Live Trees/Roots" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Live Trees/Roots" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Macrophytes" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Macrophytes" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Macrophytes" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Overhang.Veg" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Overhang.Veg" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Overhang.Veg" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Undercut Banks" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Undercut Banks" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Undercut Banks" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Woody Debris <0.3 m" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Woody Debris <0.3 m" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Woody Debris <0.3 m" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Fish Cover Woody Debris >0.3 m" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Fish Cover Woody Debris >0.3 m" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Fish Cover Woody Debris >0.3 m" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Float Time" & Result < 0 ~ "QAORR",
    AnalyteName == "Float Time" & Result > 100 ~ "QAORR",
    AnalyteName == "Float Time" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Gage Height" & Result < 0 ~ "QAORR",
    AnalyteName == "Gage Height" & Result > 30 ~ "QAORR",
    AnalyteName == "Gage Height" & Result %in% 0:30 ~ "Com",
    
    AnalyteName == "Glide" & Result < 0 ~ "QAORR",
    AnalyteName == "Glide" & Result > 100 ~ "QAORR",
    AnalyteName == "Glide" & Result %in% 0:100 ~ "Com",
  
    AnalyteName == "Glide/Pool Channel Alteration" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Glide/Pool Channel Alteration" & VariableResult > 20 ~ "QAORR",
    AnalyteName == "Glide/Pool Channel Alteration" & VariableResult %in% 0:20 ~ "Com",
    
    AnalyteName == "Glide/Pool Epifaunal Substrate" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Glide/Pool Epifaunal Substrate" & VariableResult > 20 ~ "QAORR",
    AnalyteName == "Glide/Pool Epifaunal Substrate" & VariableResult %in% 0:20 ~ "Com",
    
    AnalyteName == "Glide/Pool Sediment Deposition" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Glide/Pool Sediment Deposition" & VariableResult > 20 ~ "QAORR",
    AnalyteName == "Glide/Pool Sediment Deposition" & VariableResult %in% 0:20 ~ "Com",
    
    AnalyteName == "Microalgae Thickness" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Microalgae Thickness" & VariableResult > 5 ~ "QAORR",
    AnalyteName == "Microalgae Thickness" & VariableResult %in% 0:5 ~ "Com",
    
    AnalyteName == "Pool" & Result < 0 ~ "QAORR",
    AnalyteName == "Pool" & Result > 100 ~ "QAORR",
    AnalyteName == "Pool" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Proportion" & Result < 0 ~ "QAORR",
    AnalyteName == "Proportion" & Result > 100 ~ "QAORR",
    AnalyteName == "Proportion" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Rapid" & Result < 0 ~ "QAORR",
    AnalyteName == "Rapid" & Result > 100 ~ "QAORR",  
    AnalyteName == "Rapid" & Result %in% 0:100 ~ "Com", 
    
    AnalyteName == "Riffle" & Result < 0 ~ "QAORR",
    AnalyteName == "Riffle" & Result > 100 ~ "QAORR",
    AnalyteName == "Riffle" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Riffle/Run Sediment Deposition" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riffle/Run Sediment Deposition" & VariableResult > 20 ~ "QAORR",
    AnalyteName == "Riffle/Run Sediment Deposition" & VariableResult %in% 0:20 ~ "Com",
    
    AnalyteName == "Riffle/Run Epifaunal Substrate" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riffle/Run Epifaunal Substrate" & VariableResult > 20 ~ "QAORR",
    AnalyteName == "Riffle/Run Epifaunal Substrate" & VariableResult %in% 0:20 ~ "Com",
    
    AnalyteName == "Riffle/Run Channel Alteration" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riffle/Run Channel Alteration" & VariableResult > 20 ~ "QAORR",
    AnalyteName == "Riffle/Run Channel Alteration" & VariableResult %in% 0:20 ~ "Com",
    
    AnalyteName == "Riparian GroundCover Woody Shrubs" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian GroundCover Woody Shrubs" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian GroundCover Woody Shrubs" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Bridges/Abutments" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Bridges/Abutments" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Bridges/Abutments" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Buildings" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Buildings" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Buildings" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian GroundCover Barren" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian GroundCover Barren" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian GroundCover Barren" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian GroundCover NonWoody Plants" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian GroundCover NonWoody Plants" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian GroundCover NonWoody Plants" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Landfill/Trash" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Landfill/Trash" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Landfill/Trash" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Logging" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Logging" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Logging" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Lower Canopy All Vegetation" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Lower Canopy All Vegetation" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Lower Canopy All Vegetation" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Mining" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Mining" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Mining" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Orchards/Vineyards" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Orchards/Vineyards" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Orchards/Vineyards" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Park/Lawn" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Park/Lawn" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Park/Lawn" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Pasture/Range" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Pasture/Range" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Pasture/Range" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Pavement" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Pavement" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Pavement" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Pipes" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Pipes" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Pipes" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Road" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Road" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Road" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Row Crops" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Row Crops" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Row Crops" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Upper Canopy All Trees" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Upper Canopy All Trees" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Upper Canopy All Trees" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Vegetation Management" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Vegetation Management" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Vegetation Management" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Riparian Wall/Dike" & VariableResult < 0 ~ "QAORR",
    AnalyteName == "Riparian Wall/Dike" & VariableResult > 4 ~ "QAORR",
    AnalyteName == "Riparian Wall/Dike" & VariableResult %in% 0:4 ~ "Com",
    
    AnalyteName == "Run" & Result < 0 ~ "QAORR",
    AnalyteName == "Run" & Result > 100 ~ "QAORR",
    AnalyteName == "Run" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Slope" & Result < -10 ~ "QAORR",
    AnalyteName == "Slope" & Result > 100 ~ "QAORR",
    AnalyteName == "Slope" & Result %in% -10:100 ~ "Com",
    
    AnalyteName == "StationWaterDepth" & Result < -10 ~ "QAORR",
    AnalyteName == "StationWaterDepth" & Result > 500 ~ "QAORR",
    AnalyteName == "StationWaterDepth" & Result %in% -10:500 ~ "Com",
    
    AnalyteName == "Vegetation Cover Instream" & Result < 0 ~ "QAORR",
    AnalyteName == "Vegetation Cover Instream" & Result > 100 ~ "QAORR",
    AnalyteName == "Vegetation Cover Instream" & Result %in% 0:100 ~ "Com",
    
    AnalyteName == "Velocity" & Result < 0 ~ "QAORR",
    AnalyteName == "Velocity" & Result > 3000 ~ "QAORR",
    AnalyteName == "Velocity" & Result %in% 0:3000 ~ "Com",
    
    # Wetted Width NEEDS TO BE COERCED TO NUMERIC Currently this will not affect records where Result       is not an integer   MANUAL REVIEW REQUIRED
    AnalyteName == "Wetted Width" & Result < 0 ~ "QAORR",
    AnalyteName == "Wetted Width" & Result > 50 ~ "QAORR",
    AnalyteName == "Wetted Width" & Result == 0:50 ~ "Com",
    
    AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2016_WS" & Result < 150 | AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2016_WS" & Result > 250 ~ "QAORR",
    AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2016_WS" & Result %in% 150:250 ~ "Com",
    
    AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2007_WS" & Result < 150 | AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2007_WS" & Result > 250 ~ "QAORR",
    AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2007_WS" & Result %in% 150:250 ~ "Com",
    
    AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2007_WS_Basic" & Result < 150 | AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2007_WS_Basic" & Result > 250 ~ "QAORR",
    AnalyteName == "Length Reach" & ProtocolCode == "SWAMP_2007_WS_Basic" & Result %in% 150:250 ~ "Com",
    
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2016_WS" & Result < 0 ~ "QAORR",
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2016_WS" & Result > 25 ~ "QAORR",
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2016_WS" & Result %in% 0:25 ~ "Com",
    
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2007_WS" & Result < 0 ~ "QAORR",
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2007_WS" & Result > 25 ~ "QAORR",
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2007_WS" & Result %in% 0:25 ~ "Com",
    
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2007_WS_Basic" & Result < 0 ~ "QAORR",
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2007_WS_Basic" & Result > 25 ~ "QAORR",
    AnalyteName == "Length, Segment" & ProtocolCode == "SWAMP_2007_WS_Basic" & Result %in% 0:25 ~ "Com",
    
    TRUE ~ ComplianceCode
  ))

```

```{r}
########################## VERIFICATION ###############################

  # ifelse operations in base - Retain existing Compliance Code

  # these base R transformations need to occur after mutate actions to avoid overwriting and scope       issues

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "BeaufortScale" & swamp$Result == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Microalgae Thickness" & swamp$VariableResult == "Dry", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Microalgae Thickness" & swamp$VariableResult == "UD", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Microalgae Thickness" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riffle/Run Channel Alteration" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riffle/Run Epifaunal Substrate" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riffle/Run Sediment Deposition" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Woody Shrubs" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Woody Shrubs" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Woody Shrubs" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Woody Shrubs" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Woody Shrubs" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Woody Shrubs" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Bridges/Abutments" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Bridges/Abutments" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Bridges/Abutments" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Bridges/Abutments" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Bridges/Abutments" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Bridges/Abutments" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Buildings" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Buildings" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Buildings" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Buildings" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Buildings" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Buildings" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Barren" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Barren" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Barren" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Barren" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Barren" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover Barren" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover NonWoody Plants" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover NonWoody Plants" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover NonWoody Plants" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover NonWoody Plants" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover NonWoody Plants" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian GroundCover NonWoody Plants" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Landfill/Trash" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Landfill/Trash" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Landfill/Trash" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Landfill/Trash" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Landfill/Trash" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Landfill/Trash" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Logging" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Logging" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Logging" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Logging" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Logging" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Logging" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Lower Canopy All Vegetation" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Lower Canopy All Vegetation" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Lower Canopy All Vegetation" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Lower Canopy All Vegetation" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Lower Canopy All Vegetation" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Lower Canopy All Vegetation" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Mining" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Mining" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Mining" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Mining" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Mining" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Mining" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Orchards/Vineyards" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Orchards/Vineyards" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Orchards/Vineyards" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Orchards/Vineyards" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Orchards/Vineyards" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Orchards/Vineyards" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Park/Lawn" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Park/Lawn" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Park/Lawn" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Park/Lawn" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Park/Lawn" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Park/Lawn" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pasture/Range" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pasture/Range" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pasture/Range" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pasture/Range" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pasture/Range" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pasture/Range" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pavement" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pavement" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pavement" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pavement" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pavement" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pavement" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pipes" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pipes" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pipes" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pipes" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pipes" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Pipes" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Road" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Road" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Road" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Road" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Road" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Road" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Row Crops" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Row Crops" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Row Crops" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Row Crops" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Row Crops" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Row Crops" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Upper Canopy All Trees" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Vegetation Management" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Vegetation Management" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Vegetation Management" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Vegetation Management" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Vegetation Management" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Vegetation Management" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)


swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Wall/Dike" & swamp$VariableResult == "C", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Wall/Dike" & swamp$VariableResult == "N", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Wall/Dike" & swamp$VariableResult == "Not Recorded", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Wall/Dike" & swamp$VariableResult == "B", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Wall/Dike" & swamp$VariableResult == "Y", "Com", swamp$ComplianceCode)

swamp$ComplianceCode <- ifelse(swamp$AnalyteName == "Riparian Wall/Dike" & swamp$VariableResult == "P", "Com", swamp$ComplianceCode)

```

```{r}

########################################  QA CODE VERIFICATION  #####################################

  # looks at QACode and returns QAORR if value other than None
  # looks at BatchVerificationCode
  # looks at ResQualCode
  # blank ResQualCodes indicate null values in either VariableResult or Result

swamp <-
  swamp %>%
  mutate(ComplianceCode = as.character(ifelse(QACode == "None", ComplianceCode, "QAORR"))) %>%
  mutate(BatchVerificationCode = as.character(ifelse(ComplianceCode == "Com", "NA", "NA" ))) %>%
  mutate(ResQualCode = as.character(ifelse(Result == "" &  VariableResult =="", "NR", ResQualCode)))

#View(swamp)
```

##NOTES ON OUTPUT

The output of the following is to be reviewed and imported into the final template for loading.
The result of this will require that all ComplianceCodes, ResQualCodes, and QACodes are finalized according to SWAMP business rules before loading.

The SWAMP Field Measurements and Physical Habitat Template often requires modification upon reciept. For loading, ensure that the Funding Code worksheet has been added (position sheet = 6) and has appropriate field names. As of November 2018 the current SWAMP Field Loader only accepts xls files; save file format accordingly for loading. 

```{r}
# writes dataframe to xlsx rename appropriately

write_xlsx(swamp, "SWAMP_WrtiteTest_HABITAT.xlsx", col_names = TRUE)

```

